<html>
<script src="point.js"></script>
<script src="2dg.js"></script>
<script src="polygon.js"></script>

<body>
<canvas id="canvas" width="600" height="500" style="border:1px solid #000000"></canvas>
<script>
var canvas = document.getElementById("canvas");
var ctx = canvas.getContext("2d");

init(ctx);
setInterval(redraw, 100);
var width = canvas.width;
var height = canvas.height;
var a1 = new Point(100, height);
var a2 = new Point(width, height / 4);
var b1 = new Point(10, 100);
var c1 = new Point(0, 0);
var c2 = new Point(0, 0);
var e = new Point(0, 0);

var n1 = 1;
var n2 = 2 * n1;

var o = multiply(add(a1, a2), 0.5);

canvas.addEventListener('mousemove', function(evt) {
  var rect = canvas.getBoundingClientRect();
  var x = evt.clientX;
  var y = evt.clientY;
  if (y) {
    b1.x = x;
    b1.y = y;
    
    if (o) {
      var b = basis(a2, o);
      c1 = add(multiply(rebase(new Point(1, 0), b), 100), o);
      c2 = add(multiply(rebase(new Point(0, 1), b), 100), o);
      var u = rebase(subtract(o, b1), b); 
      var c = new Point(u.x, u.y * (n1 / n2));
      e = rescale(add(rebase(c, b), o), o, 300);
    }
  }
});

function redraw() {
  if (above(b1, o, a2)) {
    clear(250);
  } else {
    clear(100, 100, 0);
  }
  stroke(0);
  line(a1, a2);
  stroke(100);
  line(b1, o);
  stroke(200);
  line(o, e);
  if (o) {
    stroke(200, 0, 0);
    line(o, c1);
    stroke(0, 200, 0);
    line(o, c2);
  }
  fill(100);
  text('n1 = 1', 10, 40);
  text('n2 = ' + Math.round(10 * n2) / 10, canvas.width / 2 + 10, 40);
}

</script>
</body>
</html>
